{"version":3,"file":"Tweaks-BmjvaS2z.js","sources":["../../node_modules/.pnpm/@mui+icons-material@5.15.13_@mui+material@5.15.13_@types+react@18.2.66_react@18.2.0/node_modules/@mui/icons-material/Settings.js","../../src/routes/Tweaks.tsx"],"sourcesContent":["\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6\"\n}), 'Settings');","import Settings from '@mui/icons-material/Settings';\nimport type { SearchResult, } from 'minisearch';\nimport React, { useCallback, useEffect, useRef, useState, } from 'react';\nimport { useTranslation, } from 'react-i18next';\n\nimport { useTweaksQuery, } from '../apis';\nimport { MaterialButton, } from '../components/Button';\nimport { Catalogue, CatalogueItem, } from '../components/Catalogue';\nimport { TweakDetailsView, } from '../components/DetailsView';\nimport { SPELL_COMMANDS, TWEAKS_REFRESH_INTERVAL, TWEAK_CATEGORIES, } from '../constants';\nimport { useAppDispatch, useAppSelector, } from '../hooks';\nimport type { Tweak, } from '../models';\nimport { addTweak, removeTweak, updateTweak, } from '../states';\nimport { handleError, } from '../utils';\n\nexport const Tweaks = () => {\n    const [ cachedTweaks, setCachedTweaks, ] = useState<Tweak[] | undefined>();\n\n    const { tweaks, } : { tweaks : Tweak[], } = useAppSelector(state => state.spell);\n\n    const { data : suggestedTweaks, error, } = useTweaksQuery(undefined, {\n        pollingInterval : TWEAKS_REFRESH_INTERVAL,\n        skip            : cachedTweaks !== undefined,\n    });\n\n    const dispatch = useAppDispatch();\n\n    const { t, } = useTranslation();\n\n    const searchResultMapper = useCallback((result : SearchResult) => ({\n        id          : result.id,\n        name        : result.name,\n        description : result.description,\n        imageUrl    : result.imageUrl,\n        infoUrl     : result.infoUrl,\n        author      : result.author,\n        parameters  : result.parameters,\n        types       : result.types,\n        values      : result.values,\n        impact      : result.impact,\n        privileged  : result.privileged,\n        sipInvolved : result.sipInvolved,\n    }), []);\n\n    const handleSelectionChange = useCallback((tweak : Tweak, selected : boolean) => dispatch(selected ? addTweak(tweak) : removeTweak(tweak)), [ dispatch, ]);\n\n    const TweakView = ({\n        tweak,\n    } : {\n        tweak : Tweak,\n    }) => {\n        const tweakRef = useRef({\n            ...tweak,\n            values : {\n                ...tweak.values,\n            },\n        });\n\n        const isSelected = tweaks.some(item => item.id === tweakRef.current.id);\n\n        const handleValueChange = (parameter : string, value? : boolean | number | string) => {\n            if (value) tweakRef.current.values[tweakRef.current.parameters.indexOf(parameter)] = value;\n        };\n\n        const handleSubmit = () => {\n            if (cachedTweaks) {\n                const newCachedTweaks = [\n                    ...cachedTweaks,\n                ];\n\n                newCachedTweaks[newCachedTweaks.findIndex(cachedTweak => cachedTweak.id === tweakRef.current.id)] = tweakRef.current;\n\n                setCachedTweaks(newCachedTweaks);\n            }\n\n            if (tweaks.some(selectedTweak => selectedTweak.id === tweakRef.current.id)) dispatch(updateTweak(tweakRef.current));\n        };\n\n        useEffect(() => {\n            tweakRef.current = {\n                ...tweak,\n                values : {\n                    ...tweak.values,\n                },\n            };\n        }, [ tweak, ]);\n\n        return (\n            <CatalogueItem\n                selected={isSelected}\n                item={tweakRef.current}\n                detailsView={\n                    <TweakDetailsView\n                        description={tweakRef.current.description}\n                        infoUrl={tweakRef.current.infoUrl}\n                        source={tweakRef.current.author ?? ''}\n                        parameters={tweakRef.current.parameters}\n                        types={tweakRef.current.types}\n                        values={tweakRef.current.values}\n                        onChange={handleValueChange} />\n                }\n                dialogAction={\n                    <MaterialButton\n                        color='secondary'\n                        variant='contained'\n                        onClick={handleSubmit}>\n                        {t('action.save')}\n                    </MaterialButton>\n                }\n                actionText={isSelected ? t('action.configure') : undefined}\n                actionIcon={isSelected ? <Settings /> : undefined}\n                onSelectionChange={handleSelectionChange} />\n        );\n    };\n\n    const renderCatalogueItem = (tweak : Tweak) => (\n        <TweakView\n            key={tweak.id}\n            tweak={tweak} />\n    );\n\n    useEffect(() => {\n        if (suggestedTweaks) setCachedTweaks(suggestedTweaks);\n    }, [ suggestedTweaks, ]);\n\n    useEffect(() => {\n        if (error) {\n            if ('status' in error && (error.status === 404 || error.status === 'FETCH_ERROR' || error.status === 'TIMEOUT_ERROR')) {\n                console.error(error);\n            } else {\n                handleError(error);\n            }\n        }\n    }, [ error, ]);\n\n    return (\n        <Catalogue\n            suggestedItems={cachedTweaks}\n            downloadedItems={cachedTweaks}\n            tagLine={t('tweaks.tagline')}\n            searchHint={t('tweaks.search.hint')}\n            title={t('tweaks.about.title')}\n            description={t('tweaks.about.description')}\n            commands={SPELL_COMMANDS}\n            categories={TWEAK_CATEGORIES}\n            itemFields={[\n                'id',\n                'name',\n                'description',\n                'imageUrl',\n                'infoUrl',\n                'author',\n                'parameters',\n                'types',\n                'values',\n                'impact',\n                'privileged',\n                'sipInvolved',\n            ]}\n            loadingMessage={t('tweaks.loading')}\n            renderCatalogueItem={renderCatalogueItem}\n            searchResultMapper={searchResultMapper}\n        />\n    );\n};\n"],"names":["_interopRequireDefault","require$$0","Settings","default_1","_createSvgIcon","require$$1","_jsxRuntime","require$$2","Tweaks","cachedTweaks","setCachedTweaks","useState","tweaks","useAppSelector","state","suggestedTweaks","error","useTweaksQuery","TWEAKS_REFRESH_INTERVAL","dispatch","useAppDispatch","t","useTranslation","searchResultMapper","useCallback","result","handleSelectionChange","tweak","selected","addTweak","removeTweak","TweakView","tweakRef","useRef","isSelected","item","handleValueChange","parameter","value","handleSubmit","newCachedTweaks","cachedTweak","selectedTweak","updateTweak","useEffect","jsx","CatalogueItem","TweakDetailsView","MaterialButton","renderCatalogueItem","handleError","Catalogue","SPELL_COMMANDS","TWEAK_CATEGORIES"],"mappings":"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","x_google_ignoreList":[0]}